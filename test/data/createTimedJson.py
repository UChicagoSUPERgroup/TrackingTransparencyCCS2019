import json
import time
import random

random.seed(432965348756)

def getTimeArray():
	### time from May 23 to May 31
	baseTimeArray=[1527080400000, 1527084000000, 1527087600000, 1527091200000, 1527094800000, 1527098400000, 1527102000000, 1527105600000, 1527109200000, 1527112800000, 1527116400000, 1527120000000, 1527166800000, 1527170400000, 1527174000000, 1527177600000, 1527181200000, 1527184800000, 1527188400000, 1527192000000, 1527195600000, 1527199200000, 1527202800000, 1527206400000, 1527253200000, 1527256800000, 1527260400000, 1527264000000, 1527267600000, 1527271200000, 1527274800000, 1527278400000, 1527282000000, 1527285600000, 1527289200000, 1527292800000, 1527339600000, 1527343200000, 1527346800000, 1527350400000, 1527354000000, 1527357600000, 1527361200000, 1527364800000, 1527368400000, 1527372000000, 1527375600000, 1527379200000, 1527426000000, 1527429600000, 1527433200000, 1527436800000, 1527440400000, 1527444000000, 1527447600000, 1527451200000, 1527454800000, 1527458400000, 1527462000000, 1527465600000, 1527512400000, 1527516000000, 1527519600000, 1527523200000, 1527526800000, 1527530400000, 1527534000000, 1527537600000, 1527541200000, 1527544800000, 1527548400000, 1527552000000, 1527598800000, 1527602400000, 1527606000000, 1527609600000, 1527613200000, 1527616800000, 1527620400000, 1527624000000, 1527627600000, 1527631200000, 1527634800000, 1527638400000, 1527685200000, 1527688800000, 1527692400000, 1527696000000, 1527699600000, 1527703200000, 1527706800000, 1527710400000, 1527714000000, 1527717600000, 1527721200000, 1527724800000] 

	##adjust it to your current timestamp
	newTimeArray=[]
	diff = int(time.time())*1000 - baseTimeArray[-1]
	## create new timearray
	for b in baseTimeArray:newTimeArray.append(b+diff)
	return newTimeArray

def changeTS(st):
	newTimeArray = getTimeArray()
	pageTSMap={}
	for p in st['pages']:
  		rand1 = random.sample(newTimeArray, 1)
  		rand2 = random.randint(10, 3600000 - 1)
  		pageId = rand1[0] + rand2;  
		pageTSMap[p['id']]=pageId

	for i in range(0, len(st['pages'])):
		st['pages'][i]['id'] = pageTSMap[st['pages'][i]['id']]

	for i in range(0, len(st['inferences'])):
		st['inferences'][i]['pageId'] = pageTSMap[st['inferences'][i]['pageId']]

	for i in range(0, len(st['trackers'])):
		st['trackers'][i]['pageId'] = pageTSMap[st['trackers'][i]['pageId']]
	return st

f=open('tt_export.json').read()
st=json.loads(f)
st1=changeTS(st)

fout=open('tt_export_newtime.json', 'w')
fout.write(json.dumps(st1, sort_keys=True, indent=4))
fout.close()
